<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="PairViz">
<title>Multiple comparisons with PairViz • PairViz</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multiple comparisons with PairViz">
<meta property="og:description" content="PairViz">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PairViz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/MultipleComparisons.html">Multiple comparisons with PairViz</a>
    <a class="dropdown-item" href="../articles/PairVizIntroduction.html">Introduction to PairViz</a>
    <a class="dropdown-item" href="../articles/pcp.html">Correlation and scagnostic guided parallel coordinate plots</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="MultipleComparisons_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Multiple comparisons with PairViz</h1>
                        <h4 data-toc-skip class="author">Catherine B. Hurley and R.W. Oldford</h4>
            
            <h4 data-toc-skip class="date">2022-01-11</h4>
      
      
      <div class="d-none name"><code>MultipleComparisons.Rmd</code></div>
    </div>

    
    
<p>PairViz is an R package which provides orderings of objects for visualisation purposes. This vignette demonstrates the use of PairViz for comparing distributions. We recommend that you check out the material in the accompanying vignette ‘Introduction to PairViz’ prior to this.</p>
<div class="section level2">
<h2 id="cancer-treatment-groups">Cancer treatment groups<a class="anchor" aria-label="anchor" href="#cancer-treatment-groups"></a>
</h2>
<p>Patients with advanced cancers of the stomach, bronchus, colon, ovary or breast were treated with ascorbate. Interest lies in understanding whether patient survival time (in days, it seems) is different depending on the organ affected by cancer.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cbhurley.github.io/PairViz">PairViz</a></span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>  <span class="co"># Need this step to load the data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>   <span class="co"># Summary of structure of the data</span>
<span class="co">#&gt; 'data.frame':    64 obs. of  2 variables:</span>
<span class="co">#&gt;  $ Survival: int  124 42 25 45 412 51 1112 46 103 876 ...</span>
<span class="co">#&gt;  $ Organ   : Factor w/ 5 levels "Breast","Bronchus",..: 5 5 5 5 5 5 5 5 5 5 ...</span>
<span class="co"># We can separate the survival times by which organ is affected</span>
<span class="va">organs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">cancer</span>, <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Survival</span>, <span class="va">Organ</span><span class="op">)</span><span class="op">)</span>
<span class="co"># And record their names for use later!</span>
<span class="va">organNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">organs</span><span class="op">)</span>
<span class="co"># the structure of the organs data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">organs</span><span class="op">)</span>
<span class="co">#&gt; List of 5</span>
<span class="co">#&gt;  $ Breast  : int [1:11] 1235 24 1581 1166 40 727 3808 791 1804 3460 ...</span>
<span class="co">#&gt;  $ Bronchus: int [1:17] 81 461 20 450 246 166 63 64 155 859 ...</span>
<span class="co">#&gt;  $ Colon   : int [1:17] 248 377 189 1843 180 537 519 455 406 365 ...</span>
<span class="co">#&gt;  $ Ovary   : int [1:6] 1234 89 201 356 2970 456</span>
<span class="co">#&gt;  $ Stomach : int [1:13] 124 42 25 45 412 51 1112 46 103 876 ...</span></code></pre></div>
<p>Boxplots of the cancer survival times are:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://colorspace.R-Forge.R-project.org/" class="external-link">colorspace</a></span><span class="op">)</span>
<span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://colorspace.R-Forge.R-project.org//reference/rainbow_hcl.html" class="external-link">rainbow_hcl</a></span><span class="op">(</span><span class="fl">5</span>, c <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>  <span class="co"># choose chromaticity of 50 to dull colours</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">organs</span>, col<span class="op">=</span><span class="va">cols</span>, 
        ylab<span class="op">=</span><span class="st">"Survival time"</span>, 
        main<span class="op">=</span><span class="st">"Cancer treated by vitamin C"</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleComparisons_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Taking square roots should make the data look a little less asymmetric.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Split the data</span>
<span class="va">sqrtOrgans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">cancer</span>, <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">Survival</span><span class="op">)</span>, <span class="va">Organ</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">sqrtOrgans</span>, col<span class="op">=</span><span class="va">cols</span>, 
        ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="st">"Survival time"</span><span class="op">)</span><span class="op">)</span>, 
        main<span class="op">=</span><span class="st">"Cancer treated by vitamin C"</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleComparisons_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="layout-via-graph-structure">Layout via graph structure<a class="anchor" aria-label="anchor" href="#layout-via-graph-structure"></a>
</h2>
<p>Suppose we would like to compare every organ type with every other. To find an order, we need to find an Eulerian for a complete graph of <span class="math inline">\(k=5\)</span> nodes.</p>
<p>This can be found with the <code>PairViz</code> function <code><a href="../reference/eulerian.html">eulerian()</a></code> as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eulerian.html">eulerian</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="va">ord</span>
<span class="co">#&gt;  [1] 1 2 3 1 4 2 5 3 4 5 1</span></code></pre></div>
<p>We can use the constructed <code>ord</code> vectors to form boxplots:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">sqrtOrgans</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, 
        ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="st">"Survival time"</span><span class="op">)</span><span class="op">)</span>, 
        main<span class="op">=</span><span class="st">"Cancer treated by vitamin C"</span>, cex.axis<span class="op">=</span><span class="fl">.6</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleComparisons_files/figure-html/unnamed-chunk-5-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Every pair of comparisons appear adjacently to one another. We have also taken care to assign each cancer type the same colour across all the boxplots. Note that this Eulerian order does not show all organs (colours) in the first five boxplots. That is, it is not one Hamiltonian followed by another. If a Hamiltonian is required, then replace ord in the plot above with</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ordHam</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/hpaths.html">hpaths</a></span><span class="op">(</span><span class="fl">5</span>, matrix <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">ordHam</span>
<span class="co">#&gt;  [1] 1 2 3 5 4 1 3 4 2 5 1</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pairwise-tests">Pairwise tests<a class="anchor" aria-label="anchor" href="#pairwise-tests"></a>
</h2>

<p>We could, for example, run some statistical test comparing each pair and then use the observed significance level for that test.</p>
<p>Suppose we test the equality of each pairwise means (assuming normal distributions of course). A function in <code>R</code> that accomplishes this (and which corrects the p-values for simultaneity, though this doesn’t matter for our purpose of simply ordering) is <code>pairwise.t.test</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get the test results</span>
<span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">cancer</span>,
             <span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html" class="external-link">pairwise.t.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">Survival</span><span class="op">)</span>, <span class="va">Organ</span><span class="op">)</span><span class="op">)</span>
<span class="va">pvals</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">$</span><span class="va">p.value</span>
<span class="va">pvals</span>
<span class="co">#&gt;            Breast Bronchus  Colon  Ovary</span>
<span class="co">#&gt; Bronchus 0.000242       NA     NA     NA</span>
<span class="co">#&gt; Colon    0.023008   0.5087     NA     NA</span>
<span class="co">#&gt; Ovary    0.751431   0.1703 0.7514     NA</span>
<span class="co">#&gt; Stomach  0.001261   0.7766 0.7514 0.2934</span></code></pre></div>
<p>From this we can see that in testing the hypothesis that the mean <span class="math inline">\(\sqrt{Survival}\)</span> is identical for those with colon cancer and those with breast cancer, the observed significance level (or “p-value”) is about 0.023. This low value indicates evidence against the hypothesis that the means are identical.</p>
<p>Note the shape of the output (compare row names to column names). This will require a little work to put it into a more useful form. Our goal here is to construct a symmetric matrix where each entry is a p-value comparing two groups.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># First construct a vector, removing NAs.</span>
<span class="va">weights</span> <span class="op">&lt;-</span> <span class="va">pvals</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">pvals</span><span class="op">)</span><span class="op">]</span>
<span class="va">weights</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/pathweights.html">edge2dist</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></code></pre></div>
<p>edge2dist is a utility function in PairViz that converts the values in the input vector into a dist. A matrix with labelled rows and columns is more useful to us:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TSP/man/ATSP.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">organNames</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span>
<span class="va">weights</span>
<span class="co">#&gt;            Breast Bronchus   Colon  Ovary  Stomach</span>
<span class="co">#&gt; Breast   0.000000 0.000242 0.02301 0.7514 0.001261</span>
<span class="co">#&gt; Bronchus 0.000242 0.000000 0.50872 0.1703 0.776598</span>
<span class="co">#&gt; Colon    0.023008 0.508725 0.00000 0.7514 0.751431</span>
<span class="co">#&gt; Ovary    0.751431 0.170253 0.75143 0.0000 0.293361</span>
<span class="co">#&gt; Stomach  0.001261 0.776598 0.75143 0.2934 0.000000</span></code></pre></div>
<p>Check that the weight values correctly correspond to p-values. Imagine the graph, with the boxplots (or organs) as nodes, and edges being the comparisons. We could assign <strong>weights to the edges</strong> of the graph that were identical to the significance levels.</p>
</div>
<div class="section level2">
<h2 id="aside-construction-and-display-of-the-graph">(Aside) Construction and display of the graph<a class="anchor" aria-label="anchor" href="#aside-construction-and-display-of-the-graph"></a>
</h2>
<p>Here is the graph:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mk_complete_graph.html">mk_complete_graph</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span></code></pre></div>
<p>To plot the graph in igraph use</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"igraph"</span><span class="op">)</span>
<span class="co">#&gt; Loading required namespace: igraph</span>
<span class="va">igplot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">g</span>,<span class="va">weights</span><span class="op">=</span><span class="cn">FALSE</span>,<span class="va">layout</span><span class="op">=</span><span class="fu">igraph</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/igraph/man/layout_in_circle.html" class="external-link">layout_in_circle</a></span>, 
                   <span class="va">vertex.size</span><span class="op">=</span><span class="fl">60</span>, <span class="va">vertex.color</span><span class="op">=</span><span class="st">"lightblue"</span>,<span class="va">...</span><span class="op">)</span><span class="op">{</span>
    <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_graphnel.html" class="external-link">graph_from_graphnel</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">"graphNEL"</span><span class="op">)</span><span class="op">)</span>
    <span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">weights</span><span class="op">)</span><span class="op">{</span>
      <span class="va">ew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/edge_attr.html" class="external-link">get.edge.attribute</a></span><span class="op">(</span><span class="va">g</span>,<span class="st">"weight"</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span> 
      <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/plot.igraph.html" class="external-link">plot.igraph</a></span><span class="op">(</span><span class="va">g</span>,layout<span class="op">=</span><span class="va">layout</span>,edge.label<span class="op">=</span><span class="va">ew</span>,vertex.size<span class="op">=</span><span class="va">vertex.size</span>,vertex.color<span class="op">=</span><span class="va">vertex.color</span>,<span class="va">...</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="kw">else</span>
    <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/plot.igraph.html" class="external-link">plot.igraph</a></span><span class="op">(</span><span class="va">g</span>,layout<span class="op">=</span><span class="va">layout</span>,vertex.size<span class="op">=</span><span class="va">vertex.size</span>,vertex.color<span class="op">=</span><span class="va">vertex.color</span>,<span class="va">...</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">igplot</span><span class="op">(</span><span class="va">g</span>,weights<span class="op">=</span><span class="cn">TRUE</span>,edge.label.color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleComparisons_files/figure-html/unnamed-chunk-11-1.png" width="480" style="display: block; margin: auto;"></p>
<p>To plot the graph in Rgraphviz use:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">Rgraphviz</span><span class="op">)</span>
<span class="va">ew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/edgeWeights.html" class="external-link">edgeWeights</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">ew</span> <span class="op">&lt;-</span> <span class="va">ew</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>along<span class="op">=</span><span class="va">ew</span><span class="op">)</span>, <span class="fu">removedEdges</span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ew</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/graph/man/graph-class.html" class="external-link">edgeNames</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g</span>,  <span class="st">"circo"</span>,edgeAttrs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">ew</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visiting-edges-and-nodes">Visiting edges and nodes<a class="anchor" aria-label="anchor" href="#visiting-edges-and-nodes"></a>
</h2>
<p>We might then ask whether we could have a path that</p>
<ul>
<li>visited all <strong>edges</strong> but preferred to visit low-weight (or high weight) edges soonest (a greedy Eulerian)
<ul>
<li>this is particularly useful if not all edges can be visited (for whatever reason)</li>
</ul>
</li>
<li>visited every <strong>node</strong> but had the least (or most) total weight</li>
</ul>
<p>This greedy Eulerian visits all edges, arranging the path so low weight edges are encountered early.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">low2highEulord</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eulerian.html">eulerian</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span><span class="op">[</span><span class="va">low2highEulord</span><span class="op">]</span>
<span class="co">#&gt;  [1] "Bronchus" "Breast"   "Stomach"  "Ovary"    "Bronchus" "Colon"   </span>
<span class="co">#&gt;  [7] "Breast"   "Ovary"    "Colon"    "Stomach"  "Bronchus"</span>
<span class="co">## or equivalently</span>
<span class="fu"><a href="../reference/eulerian.html">eulerian</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>
<span class="co">#&gt;  [1] "Bronchus" "Breast"   "Stomach"  "Ovary"    "Bronchus" "Colon"   </span>
<span class="co">#&gt;  [7] "Breast"   "Ovary"    "Colon"    "Stomach"  "Bronchus"</span></code></pre></div>
<p>This path visits all nodes exactly once, choosing a path whose total weight is lowest.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bestHam</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/order_best.html">order_best</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span><span class="op">[</span><span class="va">bestHam</span><span class="op">]</span>
<span class="co">#&gt; [1] "Colon"    "Breast"   "Bronchus" "Ovary"    "Stomach"</span></code></pre></div>
<p>Using the path <code>low2highEulord</code> to order the boxplots, we get</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">sqrtOrgans</span><span class="op">[</span><span class="va">low2highEulord</span><span class="op">]</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="va">ord</span><span class="op">]</span>, 
        ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="st">"Survival time"</span><span class="op">)</span><span class="op">)</span>, 
        main<span class="op">=</span><span class="st">"Cancer treated by vitamin C"</span>, cex.axis<span class="op">=</span><span class="fl">.6</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleComparisons_files/figure-html/unnamed-chunk-15-1.png" width="720" style="display: block; margin: auto;"></p>
<p>In this display the pairs of cancers with the biggest differences in survival times appear early in the sequence. This arrangement should help to focus the viewer’s attention on the differences between the survival times across organ types.</p>
<p>Comparisons can be assisted by inserting some visual representation of the pairwise difference in between pairs of boxplots. We will use a visualisation of a confidence interval for the difference in population means, adjusted for multiple comparisons, like that given by <code>TukeyHSD</code>.</p>
</div>
<div class="section level2">
<h2 id="multiple-comparisons-with-tukeys-hsd">Multiple comparisons with Tukey’s HSD<a class="anchor" aria-label="anchor" href="#multiple-comparisons-with-tukeys-hsd"></a>
</h2>
<p>First we carry out an anova analysis comparing the groups.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aovOrgans</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">Survival</span><span class="op">)</span> <span class="op">~</span> <span class="va">Organ</span>,data<span class="op">=</span><span class="va">cancer</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">aovOrgans</span>,conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>
<span class="co">#&gt;   Tukey multiple comparisons of means</span>
<span class="co">#&gt;     95% family-wise confidence level</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fit: aov(formula = sqrt(Survival) ~ Organ, data = cancer)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Organ</span>
<span class="co">#&gt;                     diff     lwr    upr  p adj</span>
<span class="co">#&gt; Bronchus-Breast  -19.993 -32.265 -7.720 0.0002</span>
<span class="co">#&gt; Colon-Breast     -13.566 -25.839 -1.293 0.0232</span>
<span class="co">#&gt; Ovary-Breast      -7.622 -23.718  8.475 0.6724</span>
<span class="co">#&gt; Stomach-Breast   -18.809 -31.802 -5.816 0.0013</span>
<span class="co">#&gt; Colon-Bronchus     6.427  -4.452 17.305 0.4647</span>
<span class="co">#&gt; Ovary-Bronchus    12.371  -2.690 27.432 0.1558</span>
<span class="co">#&gt; Stomach-Bronchus   1.184 -10.502 12.869 0.9985</span>
<span class="co">#&gt; Ovary-Colon        5.944  -9.116 21.005 0.8003</span>
<span class="co">#&gt; Stomach-Colon     -5.243 -16.928  6.443 0.7148</span>
<span class="co">#&gt; Stomach-Ovary    -11.187 -26.841  4.466 0.2735</span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD()</a></code> results give confidence intervals comparing population means, and p-values for the pairwise tests. These p-values are slightly different to those from <code><a href="https://rdrr.io/r/stats/pairwise.t.test.html" class="external-link">pairwise.t.test()</a></code> as the method of correction for pairwise comparison is different. They may also be used to form a graph, and an Eulerian which favours low weights:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tuk</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">aovOrgans</span>,conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>
<span class="va">ptuk</span> <span class="op">&lt;-</span> <span class="va">tuk</span><span class="op">$</span><span class="va">Organ</span><span class="op">[</span>,<span class="st">"p adj"</span><span class="op">]</span>
<span class="va">dtuk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TSP/man/ATSP.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="../reference/pathweights.html">edge2dist</a></span><span class="op">(</span><span class="va">ptuk</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dtuk</span><span class="op">)</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dtuk</span><span class="op">)</span><span class="op">&lt;-</span> <span class="va">organNames</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mk_complete_graph.html">mk_complete_graph</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span>
<span class="fu"><a href="../reference/eulerian.html">eulerian</a></span><span class="op">(</span><span class="va">dtuk</span><span class="op">)</span>
<span class="co">#&gt;  [1] 2 1 5 4 2 3 1 4 3 5 2</span></code></pre></div>
<p>In this cases the Eulerian calculated from the <code>TukeyHSD</code> p-values coincides with that from the <code>pairwise.t.test</code> results.</p>
<p>We can also plot the Tukey confidence intervals using</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">8</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD</a></span><span class="op">(</span><span class="va">aovOrgans</span>,conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>,las<span class="op">=</span><span class="fl">1</span>,tcl <span class="op">=</span> <span class="op">-</span><span class="fl">.3</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleComparisons_files/figure-html/unnamed-chunk-18-1.png" width="480"></p>
<p>We wish to construct a plot that includes</p>
<ul>
<li><p>the boxplots of the survival times by group with all pairs adjacent</p></li>
<li><p>and, a confidence visualisation in between each pair of boxplots.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="boxplots-with-pairwise-testing-vitamin-c">Boxplots With Pairwise Testing: Vitamin C<a class="anchor" aria-label="anchor" href="#boxplots-with-pairwise-testing-vitamin-c"></a>
</h2>
<p>In PairViz, we provide a function <code>mcplots()</code> which interleaves group boxplots and a confidence interval visualisation:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="../reference/mc_plot.html">mc_plot</a></span><span class="op">(</span><span class="va">sqrtOrgans</span>,<span class="va">aovOrgans</span>,main<span class="op">=</span><span class="st">"Pairwise comparisons of cancer types"</span>, 
        ylab<span class="op">=</span><span class="st">"Sqrt Survival"</span>,col<span class="op">=</span><span class="va">cols</span>,cex.axis<span class="op">=</span><span class="fl">.6</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleComparisons_files/figure-html/unnamed-chunk-19-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Some of the features of this plot are</p>
<ul>
<li><p>The boxplots are ordered using an Eulerian of the <code>TukeyHSD</code> p-values, computed from <code>aovOrgans</code>.</p></li>
<li><p>By default boxplots have variable width, reflecting group sizes. See the documentation for parameter <code>varwidth</code> to adjust this.</p></li>
<li><p>The gray vertical strip between each pair of boxplots depicts the HSD confidence interval for the diference in means from the distributions in the two boxplots.</p></li>
<li><p>The circle in the middle of the gray strip is the point estimate for the difference in means</p></li>
<li><p>The axis on the left hand side refers to the boxplots, the right hand axis refers to the confidence intervals.</p></li>
<li><p>Three levels of confidence are depicted by the gray strips. The light grey part shows a 90% interval. Moving out to include the mid-gray section gives a 95% interval. Including the dark gray section gives a 99% confidence interval. The confidence levels of displayed intervals is controlled by the <code>levels</code> parameter of <code><a href="../reference/mc_plot.html">mc_plot()</a></code>.</p></li>
<li><p>The horizontal gray line segments shows the zero value of the right hand or confidence interval axis.</p></li>
<li><p>Confidence intervals which do not intersect the zero axis represent comparisons whose p-values are less than 0.01.</p></li>
<li><p>The red arrows depict comparisons where the confidence interval does not intersect the zero axis. Longer arrows mean greater significance, i.e. smaller p-values.</p></li>
</ul>
<p>Suppose you wish to use <code>mc_plot</code> to depict confidence intervals other than those given by <code>TukeyHSD</code>. This is possible, once we can construct a matrix with the necessary information, that is, the first column is estimate, then is followed by lower and upper confidence bounds for a number of confidence levels. In this case, the required order should be supplied as the <code>path</code> input.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://multcomp.R-forge.R-project.org" class="external-link">multcomp</a></span><span class="op">)</span><span class="op">)</span>
<span class="va">fitVitC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">glht</a></span><span class="op">(</span><span class="va">aovOrgans</span>, linfct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">mcp</a></span><span class="op">(</span>Organ<span class="op">=</span> <span class="st">"Tukey"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># this gives confidence intervals without a family correction</span>
<span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fitVitC</span>,level<span class="op">=</span><span class="fl">.99</span>,calpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/methods.html" class="external-link">univariate_calpha</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Simultaneous Confidence Intervals</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Multiple Comparisons of Means: Tukey Contrasts</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fit: aov(formula = sqrt(Survival) ~ Organ, data = cancer)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Quantile = 2.662</span>
<span class="co">#&gt; 99% confidence level</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Linear Hypotheses:</span>
<span class="co">#&gt;                         Estimate lwr     upr    </span>
<span class="co">#&gt; Bronchus - Breast == 0  -19.993  -31.602  -8.384</span>
<span class="co">#&gt; Colon - Breast == 0     -13.566  -25.175  -1.957</span>
<span class="co">#&gt; Ovary - Breast == 0      -7.622  -22.848   7.604</span>
<span class="co">#&gt; Stomach - Breast == 0   -18.809  -31.100  -6.518</span>
<span class="co">#&gt; Colon - Bronchus == 0     6.427   -3.864  16.717</span>
<span class="co">#&gt; Ovary - Bronchus == 0    12.371   -1.875  26.617</span>
<span class="co">#&gt; Stomach - Bronchus == 0   1.184   -9.870  12.237</span>
<span class="co">#&gt; Ovary - Colon == 0        5.944   -8.302  20.191</span>
<span class="co">#&gt; Stomach - Colon == 0     -5.243  -16.296   5.811</span>
<span class="co">#&gt; Stomach - Ovary == 0    -11.187  -25.994   3.620</span>

<span class="co"># for short, define</span>
<span class="va">cifunction</span><span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">f</span>, <span class="va">lev</span><span class="op">)</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">f</span>,level<span class="op">=</span><span class="va">lev</span>,calpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/methods.html" class="external-link">univariate_calpha</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">confint</span>

<span class="co"># calculate the confidence intervals</span>
<span class="va">conf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu">cifunction</span><span class="op">(</span><span class="va">fitVitC</span>,<span class="fl">.9</span><span class="op">)</span>,<span class="fu">cifunction</span><span class="op">(</span><span class="va">fitVitC</span>,<span class="fl">.95</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="fu">cifunction</span><span class="op">(</span><span class="va">fitVitC</span>,<span class="fl">.99</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>


<span class="fu"><a href="../reference/mc_plot.html">mc_plot</a></span><span class="op">(</span><span class="va">sqrtOrgans</span>,<span class="va">conf</span>,path<span class="op">=</span><span class="va">low2highEulord</span>,
        main<span class="op">=</span><span class="st">"Pairwise comparisons of cancer types"</span>, 
        ylab<span class="op">=</span><span class="st">"Sqrt Survival"</span>,col<span class="op">=</span><span class="va">cols</span>,cex.axis<span class="op">=</span><span class="fl">.6</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleComparisons_files/figure-html/unnamed-chunk-20-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Without the family-wise correction, the Breast-Colon comparison is also significant.</p>
</div>
<div class="section level2">
<h2 id="subsets-of-comparisons-mice-diets">Subsets of comparisons: Mice Diets<a class="anchor" aria-label="anchor" href="#subsets-of-comparisons-mice-diets"></a>
</h2>
<!-- To do mice example with reduced set of comparisons -->
<!-- see files cables/diet.R and dietsleuth.R -->
<p>Female mice were randomly assigned to six treatment groups to investigate whether restricting dietary intake increases life expectancy. The data is available as</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"Sleuth3"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"Sleuth3"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://r-forge.r-project.org/projects/sleuth2/" class="external-link">Sleuth3</a></span><span class="op">)</span>
<span class="va">mice</span> <span class="op">&lt;-</span> <span class="va">case0501</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mice</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    349 obs. of  2 variables:</span>
<span class="co">#&gt;  $ Lifetime: num  35.5 35.4 34.9 34.8 33.8 33.5 32.6 32.4 31.8 31.6 ...</span>
<span class="co">#&gt;  $ Diet    : Factor w/ 6 levels "N/N85","N/R40",..: 4 4 4 4 4 4 4 4 4 4 ...</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">mice</span><span class="op">$</span><span class="va">Diet</span><span class="op">)</span>
<span class="co">#&gt; [1] "N/N85" "N/R40" "N/R50" "NP"    "R/R50" "lopro"</span>
<span class="co"># get rid of "/"</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">mice</span><span class="op">$</span><span class="va">Diet</span><span class="op">)</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NN85"</span>, <span class="st">"NR40"</span>, <span class="st">"NR50"</span>, <span class="st">"NP"</span> ,   <span class="st">"RR50"</span> ,<span class="st">"lopro"</span><span class="op">)</span></code></pre></div>
<p>Plot the data:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">life</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mice</span>, <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Lifetime</span> ,<span class="va">Diet</span><span class="op">)</span><span class="op">)</span>
<span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://colorspace.R-Forge.R-project.org//reference/rainbow_hcl.html" class="external-link">rainbow_hcl</a></span><span class="op">(</span><span class="fl">6</span>, c <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">life</span>, col<span class="op">=</span><span class="va">cols</span>, 
        ylab<span class="op">=</span><span class="st">"Lifetime"</span>, 
        main<span class="op">=</span><span class="st">"Diet Restriction and Longevity"</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleComparisons_files/figure-html/unnamed-chunk-22-1.png" width="576" style="display: block; margin: auto;"></p>
<p>While there are 6 treatment groups with 15 pairwise comparisons, five of the comparisons are of particular interest. These are N/R50 vs N/N85, R/R50 vs N/R50, N/R40 vs N/R50, lopro vs N/R50 and N/N85 vs NP. See the documentation for case0501 for more details.</p>
<p>This analysis follows that given in the documentation for case0501.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aovMice</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">Lifetime</span> <span class="op">~</span> <span class="va">Diet</span><span class="op">-</span><span class="fl">1</span>, data<span class="op">=</span><span class="va">mice</span><span class="op">)</span>
<span class="va">fitMice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">glht</a></span><span class="op">(</span><span class="va">aovMice</span>,
          linfct<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DietNR50 - DietNN85 = 0"</span>, 
          <span class="st">"DietRR50  - DietNR50 = 0"</span>,
          <span class="st">"DietNR40  - DietNR50 = 0"</span>,
          <span class="st">"Dietlopro - DietNR50 = 0"</span>,
          <span class="st">"DietNN85  - DietNP   = 0"</span><span class="op">)</span><span class="op">)</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitMice</span>,test<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/methods.html" class="external-link">adjusted</a></span><span class="op">(</span><span class="st">"none"</span><span class="op">)</span><span class="op">)</span> <span class="co"># No multiple comparison adjust.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Simultaneous Tests for General Linear Hypotheses</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fit: aov(formula = Lifetime ~ Diet - 1, data = mice)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Linear Hypotheses:</span>
<span class="co">#&gt;                           Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; DietNR50 - DietNN85 == 0     9.606      1.188    8.09  1.1e-14 ***</span>
<span class="co">#&gt; DietRR50 - DietNR50 == 0     0.589      1.194    0.49    0.622    </span>
<span class="co">#&gt; DietNR40 - DietNR50 == 0     2.819      1.171    2.41    0.017 *  </span>
<span class="co">#&gt; Dietlopro - DietNR50 == 0   -2.611      1.194   -2.19    0.029 *  </span>
<span class="co">#&gt; DietNN85 - DietNP == 0       5.289      1.301    4.07  5.9e-05 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; (Adjusted p values reported -- none method)</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fitMice</span>, calpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/methods.html" class="external-link">univariate_calpha</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># No adjustment</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Simultaneous Confidence Intervals</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fit: aov(formula = Lifetime ~ Diet - 1, data = mice)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Quantile = 1.967</span>
<span class="co">#&gt; 95% confidence level</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Linear Hypotheses:</span>
<span class="co">#&gt;                           Estimate lwr    upr   </span>
<span class="co">#&gt; DietNR50 - DietNN85 == 0   9.606    7.270 11.942</span>
<span class="co">#&gt; DietRR50 - DietNR50 == 0   0.589   -1.759  2.936</span>
<span class="co">#&gt; DietNR40 - DietNR50 == 0   2.819    0.516  5.123</span>
<span class="co">#&gt; Dietlopro - DietNR50 == 0 -2.611   -4.959 -0.264</span>
<span class="co">#&gt; DietNN85 - DietNP == 0     5.289    2.730  7.848</span></code></pre></div>
<p>Four of the five comparisons are significant.</p>
</div>
<div class="section level2">
<h2 id="boxplots-with-pairwise-testing-mice-diets">Boxplots With Pairwise Testing: Mice Diets<a class="anchor" aria-label="anchor" href="#boxplots-with-pairwise-testing-mice-diets"></a>
</h2>
<p>Our goal here is to construct a multiple comparisons boxplot showing confidence intervals only for the comparisons of interest, as calculated above.</p>
<p>First we make a graph whose nodes are diets. The graph has no edges.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"graphNEL"</span>, nodes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">life</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Next add edges for the comparisons of interest, whose weights are p-values. To draw the graph, I specified the coordinates of the nodes via the layout parameter.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fitMiceSum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitMice</span>,test<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/methods.html" class="external-link">adjusted</a></span><span class="op">(</span><span class="st">"none"</span><span class="op">)</span><span class="op">)</span>
<span class="va">pvalues</span> <span class="op">&lt;-</span> <span class="va">fitMiceSum</span><span class="op">$</span><span class="va">test</span><span class="op">$</span><span class="va">pvalues</span>
<span class="va">pvalues</span>
<span class="co">#&gt;  DietNR50 - DietNN85  DietRR50 - DietNR50  DietNR40 - DietNR50 </span>
<span class="co">#&gt;            1.066e-14            6.223e-01            1.659e-02 </span>
<span class="co">#&gt; Dietlopro - DietNR50    DietNN85 - DietNP </span>
<span class="co">#&gt;            2.935e-02            5.949e-05</span>
<span class="co"># Extract  labels from the p-values for the edges</span>
<span class="va">edgeLabs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pvalues</span><span class="op">)</span>, <span class="st">" - "</span><span class="op">)</span><span class="op">)</span>
<span class="va">edgeLabs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="va">edgeLabs</span>,<span class="fl">5</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/graph/man/addEdge.html" class="external-link">addEdge</a></span><span class="op">(</span><span class="va">edgeLabs</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, <span class="va">edgeLabs</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>, <span class="va">g</span>,<span class="va">pvalues</span><span class="op">)</span>

<span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu">igplot</span><span class="op">(</span><span class="va">g</span>, weights<span class="op">=</span><span class="cn">TRUE</span>, layout<span class="op">=</span><span class="va">pos</span>,vertex.size<span class="op">=</span><span class="fl">32</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleComparisons_files/figure-html/unnamed-chunk-25-1.png" width="480" style="display: block; margin: auto;"></p>
<p>This graph is not Eulerian. It is not possible to construct a path visiting every edge that does not visit some edges more than once, or that does not insert two extra edges.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/eulerian.html">eulerian</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>
<span class="co">#&gt; [1] "NR50"  "NN85"  "NP"    "RR50"  "NR50"  "NR40"  "lopro" "NR50"</span></code></pre></div>
<p>This Eulerian inserts extra edges between NP and RR50, and NR40 and lopro. A “nicer” Eulerian might be obtained if the new edges were inserted elsewhere. These new edges are given weights of 1, to indicate the associated comparisons are uninteresting.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/graph/man/addEdge.html" class="external-link">addEdge</a></span><span class="op">(</span><span class="st">"NR40"</span>,<span class="st">"NP"</span>,<span class="va">g</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/graph/man/addEdge.html" class="external-link">addEdge</a></span><span class="op">(</span><span class="st">"lopro"</span>,<span class="st">"RR50"</span>,<span class="va">g1</span>,<span class="fl">1</span><span class="op">)</span>
<span class="fu">igplot</span><span class="op">(</span><span class="va">g1</span>, weights<span class="op">=</span><span class="cn">TRUE</span>, layout<span class="op">=</span><span class="va">pos</span>,vertex.size<span class="op">=</span><span class="fl">32</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleComparisons_files/figure-html/unnamed-chunk-27-1.png" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/eulerian.html">eulerian</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span>
<span class="co">#&gt; [1] "NR50"  "NN85"  "NP"    "NR40"  "NR50"  "lopro" "RR50"  "NR50"</span></code></pre></div>
<p>Now we are ready to construct the multiple comparisons plot.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">eul</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eulerian.html">eulerian</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span>
<span class="co"># make eul numeric</span>
<span class="va">eul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">eul</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">life</span><span class="op">)</span><span class="op">)</span>

<span class="va">fitMice1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">glht</a></span><span class="op">(</span><span class="va">aovMice</span>, linfct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html" class="external-link">mcp</a></span><span class="op">(</span>Diet<span class="op">=</span> <span class="st">"Tukey"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># need to construct the confidence intervals for all pairs</span>
<span class="va">conf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu">cifunction</span><span class="op">(</span><span class="va">fitMice1</span>,<span class="fl">.9</span><span class="op">)</span>,<span class="fu">cifunction</span><span class="op">(</span><span class="va">fitMice1</span>,<span class="fl">.95</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="fu">cifunction</span><span class="op">(</span><span class="va">fitMice1</span>,<span class="fl">.99</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="co"># these comparisons are not relevant</span>
<span class="va">conf</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">15</span><span class="op">)</span>,<span class="op">]</span><span class="op">&lt;-</span> <span class="cn">NA</span>

<span class="fu"><a href="../reference/mc_plot.html">mc_plot</a></span><span class="op">(</span><span class="va">life</span>,<span class="va">conf</span>,path<span class="op">=</span><span class="va">eul</span>,
        main<span class="op">=</span><span class="st">"Diet Restriction and Longevity"</span>, 
        ylab<span class="op">=</span><span class="st">"Lifetime"</span>,col<span class="op">=</span><span class="va">cols</span>,cex.axis<span class="op">=</span><span class="fl">.6</span><span class="op">)</span></code></pre></div>
<p><img src="MultipleComparisons_files/figure-html/unnamed-chunk-28-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Notice that confidence intervals are drawn only for the relevant comparisons. Only the first two comparisons have 99% confidence intervals which do not straddle the zero axis. These comparisons are designated by red arrows in the plot above.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Catherine Hurley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
