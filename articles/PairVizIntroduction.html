<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="PairViz">
<title>Introduction to PairViz • PairViz</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to PairViz">
<meta property="og:description" content="PairViz">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PairViz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/MultipleComparisons.html">Multiple comparisons with PairViz</a>
    <a class="dropdown-item" href="../articles/PairVizIntroduction.html">Introduction to PairViz</a>
    <a class="dropdown-item" href="../articles/pcp.html">Correlation and scagnostic guided parallel coordinate plots</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="PairVizIntroduction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to PairViz</h1>
                        <h4 data-toc-skip class="author">Catherine B. Hurley and R.W. Oldford</h4>
            
            <h4 data-toc-skip class="date">2022-08-12</h4>
      
      
      <div class="d-none name"><code>PairVizIntroduction.Rmd</code></div>
    </div>

    
    
<p>PairViz is an R package which provides orderings of objects for visualisation purposes. The problem of constructing an ordering can be regarded as traversing possibly weighted graphs. In this vignette, we focus on graphs and their traversal. Applications to data visualisation are given in accompanying vignettes.</p>
<div class="section level2">
<h2 id="pairviz-installation">PairViz installation<a class="anchor" aria-label="anchor" href="#pairviz-installation"></a>
</h2>
<p>PairViz is installed from CRAN in the usual way.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"PairViz"</span><span class="op">)</span></span></code></pre></div>
<p>PairViz uses the graph data structure provided by the graph package which is located on the Bioconductor repository rather than CRAN. To install this, use</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"graph"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span>    <span class="fu">BiocManager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"graph"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>In this vignette, we will also show plots of the graph structure, which requires package igraph from CRAN. The following utility function will be helpful:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"igraph"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: igraph</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"igraph"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"igraph"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">igplot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">g</span>,<span class="va">weights</span><span class="op">=</span><span class="cn">FALSE</span>,<span class="va">layout</span><span class="op">=</span><span class="fu">igraph</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/igraph/man/layout_in_circle.html" class="external-link">layout_in_circle</a></span>, </span>
<span>                   <span class="va">vertex.size</span><span class="op">=</span><span class="fl">60</span>, <span class="va">vertex.color</span><span class="op">=</span><span class="st">"lightblue"</span>,<span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_graphnel.html" class="external-link">graph_from_graphnel</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">"graphNEL"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">weights</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">ew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/edge_attr.html" class="external-link">get.edge.attribute</a></span><span class="op">(</span><span class="va">g</span>,<span class="st">"weight"</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>  </span>
<span>      <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/plot.igraph.html" class="external-link">plot.igraph</a></span><span class="op">(</span><span class="va">g</span>,layout<span class="op">=</span><span class="va">layout</span>,edge.label<span class="op">=</span><span class="va">ew</span>,vertex.size<span class="op">=</span><span class="va">vertex.size</span>,vertex.color<span class="op">=</span><span class="va">vertex.color</span>,<span class="va">...</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">else</span></span>
<span>    <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/plot.igraph.html" class="external-link">plot.igraph</a></span><span class="op">(</span><span class="va">g</span>,layout<span class="op">=</span><span class="va">layout</span>,vertex.size<span class="op">=</span><span class="va">vertex.size</span>,vertex.color<span class="op">=</span><span class="va">vertex.color</span>,<span class="va">...</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Alternatively, graphs may be plotted using package Rgraphviz which is installed from Bioconductor:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"Rgraphviz"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span>    <span class="fu">BiocManager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"Rgraphviz"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># For a graph g use</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="graphs">Graphs<a class="anchor" aria-label="anchor" href="#graphs"></a>
</h2>
<p>A graph is a mathematical structure made up of nodes, and edges joining those nodes. We consider only graphs where edges are undirected. In some cases, edges are assigned weights, reflecting some measure of importance.</p>
<p>A complete graph is a graph where there is an edge connecting every pair of nodes. Here are two such complete graphs, k4 with four nodes and k5 with five nodes.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cbhurley.github.io/PairViz/">PairViz</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">k4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mk_complete_graph.html">mk_complete_graph</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">k5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mk_complete_graph.html">mk_complete_graph</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu">igplot</span><span class="op">(</span><span class="va">k4</span><span class="op">)</span></span>
<span><span class="fu">igplot</span><span class="op">(</span><span class="va">k5</span><span class="op">)</span></span></code></pre></div>
<p><img src="PairVizIntroduction_files/figure-html/unnamed-chunk-5-1.png" width="700"><img src="PairVizIntroduction_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="traversing-graph-edges">Traversing graph edges<a class="anchor" aria-label="anchor" href="#traversing-graph-edges"></a>
</h2>
<p>We will first construct graph traversals that visit every edge of the graph at least once. The PairViz function <code><a href="../reference/eulerian.html">eulerian()</a></code> gives such traversals:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eulerian.html">eulerian</a></span><span class="op">(</span><span class="va">k5</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "1" "2" "3" "1" "4" "2" "5" "3" "4" "5" "1"</span></span></code></pre></div>
<p>Mathematically speaking, an Eulerian path of a graph is a path that visits every edge of a graph exactly once. An Eulerian tour of a graph is an Eulerian path that is closed, i.e. ends up at the starting node. For the graph <code>k5</code>, one such Eulerian tour goes from 1 -&gt;2 -&gt; 3 -&gt; 1 and so on until it ends back at node 1, as given by <code>eulerian(k5)</code>. It is well-known that a graph has an Eulerian tour if every node has an even number of edges. This condition holds for a complete graph with an odd number of nodes, such as <code>k5</code>.</p>
<p>Similarly, a graph has an Eulerian path if all but two nodes have an even number of edges. If we remove one edge, say that connecting nodes 1 and 2 from <code>k5</code>, these two nodes have an odd number of edges while other nodes are even.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k5a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/graph/man/removeEdge.html" class="external-link">removeEdge</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span>, <span class="va">k5</span><span class="op">)</span></span>
<span><span class="fu">igplot</span><span class="op">(</span><span class="va">k5a</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/eulerian.html">eulerian</a></span><span class="op">(</span><span class="va">k5a</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "1" "3" "2" "4" "1" "5" "3" "4" "5" "2"</span></span></code></pre></div>
<p><img src="PairVizIntroduction_files/figure-html/unnamed-chunk-7-1.png" width="700" style="display: block; margin: auto;"> The Eulerian for <code>k5a</code> starts at one of the odd nodes (here “1”) and visits all edges ending at “2”, the other odd node.</p>
<p>Most graphs are not Eulerian, that is they do not meet the conditions for an Eulerian path to exist. The graph <code>k4</code> for instance, has four nodes and all have three edges. In this case, any path visiting all edges must visit some edges more than once. This is what <code>eulerian(k4)</code> does:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eulerian.html">eulerian</a></span><span class="op">(</span><span class="va">k4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "1" "3" "2" "4" "3" "4" "1" "2"</span></span></code></pre></div>
<p>If you look closely you will see the edge connecting nodes “3” and “4” is visited twice. An other way to think of it is that extra edges need to be added to a graph so that all but two nodes become even. For <code>k4</code> only one extra edge is needed, and in the example above that extra edge connects nodes “3” and “4”.</p>
<p>In summary, for any graph, the function <code><a href="../reference/eulerian.html">eulerian()</a></code> returns a path visiting all edges at least once. If the graph is Eulerian, the returned path visits each edge exactly once. Otherwise, some edges are visited twice. For more details of this algorithm, see Hurley and Oldford (2010, 2011).</p>
</div>
<div class="section level2">
<h2 id="edge-traversal-of-a-weighted-graph">Edge traversal of a weighted graph<a class="anchor" aria-label="anchor" href="#edge-traversal-of-a-weighted-graph"></a>
</h2>
<p>First construct a graph with weighted edges.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"graphNEL"</span>,nodes<span class="op">=</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">efrom</span> <span class="op">&lt;-</span> <span class="va">n</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">eto</span> <span class="op">&lt;-</span> <span class="va">n</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">ew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">5</span><span class="op">:</span><span class="fl">7</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/graph/man/addEdge.html" class="external-link">addEdge</a></span><span class="op">(</span><span class="va">efrom</span>, <span class="va">eto</span>, <span class="va">g</span>, <span class="va">ew</span><span class="op">)</span> </span></code></pre></div>
<p>To plot the graph use</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">igplot</span><span class="op">(</span><span class="va">g</span>, weights<span class="op">=</span><span class="cn">TRUE</span>,edge.label.color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="PairVizIntroduction_files/figure-html/unnamed-chunk-10-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eulerian.html">eulerian</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "E" "D" "B" "C" "A" "B" "E"</span></span></code></pre></div>
<p>As the graph <code>g</code> is weighted, the eulerian algorithm starts at the edge with the lowest weight, and then proceeds to visit every edge, preferring lower weight edges whenever there is a choice of edge to be visited next. If the <code><a href="../reference/eulerian.html">eulerian()</a></code> function is called with the option <code>weighted=FALSE</code>, then weights are ignored.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/eulerian.html">eulerian</a></span><span class="op">(</span><span class="va">g</span>, weighted<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "A" "B" "D" "E" "B" "C" "A"</span></span></code></pre></div>
<p>In this case, the Eulerian path visits edges going next to the first available node in <code>nodes(g)</code>.</p>
</div>
<div class="section level2">
<h2 id="edge-traversal-of-a-complete-graph">Edge traversal of a complete graph<a class="anchor" aria-label="anchor" href="#edge-traversal-of-a-complete-graph"></a>
</h2>
<p>For complete graphs, PairViz includes some alternative constructions of Eulerian (or nearly Eulerian) paths.</p>
<ul>
<li><p>The function <code><a href="../reference/eseq.html">eseq()</a></code> uses a recursive algorithm, and forms a path on 1,..,n by appending extra edges on to the tour on 1,…,(n-2). For more details of the <code>eseq</code> algorithm, see Hurley and Oldford (2011).</p></li>
<li><p>The function <code><a href="../reference/eseq.html">eseqa()</a></code> gives a different sequence. For odd n, the tour starts at 1, then takes steps of size 1,2,…,m repeatedly, where m is (n-1)/2. For even n, the path constructed is formed as <code>eseqa(n+1)</code>, followed by dropping node n+1. (Note that any permulation of the step sizes 1,2,…,m would do just as well).</p></li>
</ul>
<p>Two other functions are</p>
<ul>
<li><p><code><a href="../reference/eseq.html">kntour_drop()</a></code> takes an Euler tour on the complete graph with nodes 1,2,..n as input for odd n, and removes all occurences of n from the sequence. The result is a nearly Eulerian path on the complete graph with n-1 nodes.</p></li>
<li><p><code><a href="../reference/eseq.html">kntour_add()</a></code> takes an Euler tour on the complete graph with nodes 1,2,..n as input for odd n, and appends a path joining node n+1 to each of nodes 1,2,…,n . The result is a nearly Eulerian path on the complete graph with n-1 nodes.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="edge-traversal-of-a-complete-graph-via-hamiltonian-decompositions">Edge traversal of a complete graph via Hamiltonian decompositions<a class="anchor" aria-label="anchor" href="#edge-traversal-of-a-complete-graph-via-hamiltonian-decompositions"></a>
</h2>
<p>A Hamiltonian path of a graph is a path that visits every node of a graph exactly once. For a general graph, determining whether such a path exists is difficult, and in fact is an NP-hard problem. For a complete graph of n nodes, the path 1,2,…,n is a Hamiltonian path.</p>
<p>Consider a complete graph with an odd number of nodes such as <code>k5</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/graph-class.html" class="external-link">edgeNames</a></span><span class="op">(</span><span class="va">k5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">ew</span><span class="op">[</span><span class="va">s1</span><span class="op">]</span><span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">ec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"grey40"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ew</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ec</span><span class="op">[</span><span class="va">s1</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"cyan"</span></span>
<span><span class="fu">igplot</span><span class="op">(</span><span class="va">k5</span>, edge.width<span class="op">=</span><span class="va">ew</span>, edge.color<span class="op">=</span><span class="va">ec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ew</span><span class="op">[</span><span class="op">]</span><span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">6</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">ew</span><span class="op">[</span><span class="va">s2</span><span class="op">]</span><span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">ec</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"grey40"</span></span>
<span><span class="va">ec</span><span class="op">[</span><span class="va">s2</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"magenta"</span></span>
<span><span class="fu">igplot</span><span class="op">(</span><span class="va">k5</span>, edge.width<span class="op">=</span><span class="va">ew</span>, edge.color<span class="op">=</span><span class="va">ec</span><span class="op">)</span></span></code></pre></div>
<p><img src="PairVizIntroduction_files/figure-html/unnamed-chunk-13-1.png" width="700"><img src="PairVizIntroduction_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
<p>The blue hamiltonian path visits the nodes in order 1,2,3,5,4. The pink hamiltonian path visits the nodes in order 1,3,4,2,5. For a complete graph with an odd number of nodes such as <code>k5</code>, it is possible to construct an Eulerian tour by concatenating together a number of Hamiltonians. This construction is known as a Hamiltonian decomposition.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ew</span><span class="op">[</span><span class="op">]</span><span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">ec</span><span class="op">[</span><span class="va">s1</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"cyan"</span></span>
<span><span class="va">s3</span> <span class="op">&lt;-</span> <span class="fl">3</span><span class="op">:</span><span class="fl">4</span></span>
<span><span class="va">ec</span><span class="op">[</span><span class="va">s3</span><span class="op">]</span><span class="op">&lt;-</span> <span class="st">"rosybrown1"</span></span>
<span><span class="fu">igplot</span><span class="op">(</span><span class="va">k5</span>, edge.width<span class="op">=</span><span class="va">ew</span>, edge.color<span class="op">=</span><span class="va">ec</span><span class="op">)</span></span>
<span><span class="fu">igplot</span><span class="op">(</span><span class="va">k5</span>, edge.width<span class="op">=</span><span class="va">ew</span>, edge.color<span class="op">=</span><span class="va">ec</span><span class="op">)</span></span></code></pre></div>
<p><img src="PairVizIntroduction_files/figure-html/unnamed-chunk-14-1.png" width="700" style="display: block; margin: auto;"> In the figure above, the light red edge from 4 to 1 connects the two hamiltonians, and the remaining light red edge from 5 to 1 connects the last node of the pink path to the first node from the blue path to complete the tour.</p>
<p>In PairViz, the two hamiltonian paths above are constructed by</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hpaths.html">hpaths</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    1    2    3    5    4</span></span>
<span><span class="co">#&gt; [2,]    1    3    4    2    5</span></span></code></pre></div>
<p>If you want the eulerian composed of the two hamiltonians, use</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hpaths.html">hpaths</a></span><span class="op">(</span><span class="fl">5</span>, matrix<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 1 2 3 5 4 1 3 4 2 5 1</span></span></code></pre></div>
<p>The above constructions produce paths on complete graphs with an even number of nodes which are nearly eulerian. Look at</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hpaths.html">hpaths</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span><span class="co">#&gt; [1,]    1    2    6    3    5    4</span></span>
<span><span class="co">#&gt; [2,]    2    3    1    4    6    5</span></span>
<span><span class="co">#&gt; [3,]    3    4    2    5    1    6</span></span>
<span><span class="fu"><a href="../reference/hpaths.html">hpaths</a></span><span class="op">(</span><span class="fl">6</span>, matrix<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 1 2 6 3 5 4 2 3 1 4 6 5 3 4 2 5 1 6</span></span></code></pre></div>
<p>Each row of the result of hpaths produces a hamiltonian on k6 (a complete graph with 6 nodes). When the hamiltonians are concatenated, all edges on k6 are visited. With a close inspection, we see the edges connecting the rows (here 4-2 and 5-3) are visted twice. There is no need to connect the first node of row 1 to the last node of row 3, as this edge has already been visited.</p>
<p>Other isomorphic decompositions are obtained by supplying the first Hamiltonian as an argument to hpaths. Then all node labels are rearranged accordingly, as in the code snippet below.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hpaths.html">hpaths</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,]    1    2    3    4    5</span></span>
<span><span class="co">#&gt; [2,]    1    3    5    2    4</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="edge-traversal-of-a-weighted-complete-graph-via-hamiltonian-decompositions">Edge traversal of a weighted complete graph via hamiltonian decompositions<a class="anchor" aria-label="anchor" href="#edge-traversal-of-a-weighted-complete-graph-via-hamiltonian-decompositions"></a>
</h2>
<!-- Consider the complete graph k7 whose edge weights are given by -->
<!-- ```{r, fig.align="center"} -->
<!-- set.seed(123) -->
<!-- k7 <- mk_complete_graph(7) -->
<!-- em <- edgeMatrix(k7) -->
<!-- ew <- sample(ncol(em),ncol(em)) -->
<!-- edgeData(k7, as.character(em[1,]), as.character(em[2,]), "weight") <- ew -->
<!-- igplot(k7, edge.label=ew,edge.label.color="black") -->
<!-- ``` -->
<!-- We could just as well represent the graph k7 by a distance matrix: -->
<!-- ```{r} -->
<!-- d7 <- matrix(0,7,7) -->
<!-- d7[t(em)]<- ew -->
<!-- d7[t(em)[,2:1]]<- ew -->
<!-- d7 -->
<!-- ``` -->
<p>Consider the complete graph <code>k7</code> whose edge weights are given by</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">k7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mk_complete_graph.html">mk_complete_graph</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">ew</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/graph-class.html" class="external-link">numEdges</a></span><span class="op">(</span><span class="va">k7</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/pkg/graph/man/graph-class.html" class="external-link">numEdges</a></span><span class="op">(</span><span class="va">k7</span><span class="op">)</span><span class="op">)</span> <span class="co"># a vector of edgeweights</span></span></code></pre></div>
<p>The easiest way to assign weights to edges is to use a distance matrix:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7</span>,<span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">d7</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">d7</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ew</span></span>
<span><span class="va">d7</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">d7</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">d7</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">upper.tri</a></span><span class="op">(</span><span class="va">d7</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">d7</span> </span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span></span>
<span><span class="co">#&gt; [1,]    0   15   19   14    3   10    2</span></span>
<span><span class="co">#&gt; [2,]   15    0    6   11    5    4   21</span></span>
<span><span class="co">#&gt; [3,]   19    6    0    9   13   18    8</span></span>
<span><span class="co">#&gt; [4,]   14   11    9    0    1   12   20</span></span>
<span><span class="co">#&gt; [5,]    3    5   13    1    0   17    7</span></span>
<span><span class="co">#&gt; [6,]   10    4   18   12   17    0   16</span></span>
<span><span class="co">#&gt; [7,]    2   21    8   20    7   16    0</span></span>
<span><span class="co"># or using the shortcut function edge2dist from PairViz</span></span>
<span><span class="co">#d7 &lt;- as.matrix(edge2dist(ew))</span></span></code></pre></div>
<p>Now <code>d7</code> is a symmetric matrix of distances, where the values in <code>ew</code> specify the distances in order 1-2, 1-3, …., 1-7, 2-7,…, 3-7, …,6-7.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mk_complete_graph.html">mk_complete_graph</a></span><span class="op">(</span><span class="va">d7</span><span class="op">)</span></span>
<span><span class="fu">igplot</span><span class="op">(</span><span class="va">k7</span>, weights<span class="op">=</span><span class="cn">TRUE</span>,edge.label.color<span class="op">=</span><span class="st">"black"</span>, vertex.label.cex<span class="op">=</span><span class="fl">2</span>,vertex.size<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p><img src="PairVizIntroduction_files/figure-html/unnamed-chunk-21-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Unfortunately, plot.igraph does not show graph edge weights  automatically, you have to </span></span>
<span><span class="co"># input them as above. You might want to check that the igraph</span></span>
<span><span class="co"># matches that of ew.</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html" class="external-link">E</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_graphnel.html" class="external-link">graph_from_graphnel</a></span><span class="op">(</span><span class="va">k7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; + 21/21 edges from 67e0cca (vertex names):</span></span>
<span><span class="co">#&gt;  [1] 1--2 1--3 1--4 1--5 1--6 1--7 2--3 2--4 2--5 2--6 2--7 3--4 3--5 3--6 3--7</span></span>
<span><span class="co">#&gt; [16] 4--5 4--6 4--7 5--6 5--7 6--7</span></span></code></pre></div>
<p>Like <code><a href="../reference/hpaths.html">hpaths()</a></code>, the function <code><a href="../reference/whpaths.html">weighted_hpaths()</a></code> finds Hamiltonians which when concatenated visit all edges at least once. However <code><a href="../reference/whpaths.html">weighted_hpaths()</a></code> uses a greedy algorithm to make the first Hamiltonian low weight with weights increasing for successive Hamiltonians.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/whpaths.html">weighted_hpaths</a></span><span class="op">(</span><span class="va">d7</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span></span>
<span><span class="co">#&gt; [1,]    6    2    5    4    1    7    3</span></span>
<span><span class="co">#&gt; [2,]    6    5    1    2    3    4    7</span></span>
<span><span class="co">#&gt; [3,]    6    1    3    5    7    2    4</span></span>
<span><span class="co"># this version returns the eulerian</span></span>
<span><span class="fu"><a href="../reference/whpaths.html">weighted_hpaths</a></span><span class="op">(</span><span class="va">d7</span>, matrix<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 4 5 7 1 6 2 3 4 1 5 2 7 3 6 4 2 1 3 5 6 7 4</span></span></code></pre></div>
<p>We can easily calculate the edge weights and their sum for the first Hamiltonian.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/whpaths.html">weighted_hpaths</a></span><span class="op">(</span><span class="va">d7</span>, matrix<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">o1</span> <span class="op">&lt;-</span> <span class="va">o</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span> <span class="co"># include the 8th to form the tour</span></span>
<span><span class="va">d7e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pathweights.html">dist2edge</a></span><span class="op">(</span><span class="va">d7</span><span class="op">)</span> </span>
<span><span class="co"># d7e is a vector giving edge weights in order (1,1)... (1,7), (2,3),.. (2,7) etc</span></span>
<span><span class="va">h1weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pathweights.html">path_weights</a></span><span class="op">(</span><span class="va">d7e</span>, <span class="va">o1</span><span class="op">)</span> <span class="co"># the edge weights for o1</span></span>
<span><span class="co"># the same as</span></span>
<span><span class="va">d7</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">o1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="va">o1</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  1  3  2  8  6  4 12</span></span>
<span></span>
<span><span class="va">h1weights</span></span>
<span><span class="co">#&gt; [1]  1  3  2  8  6  4 12</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">h1weights</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 36</span></span></code></pre></div>
<p>The second and third Hamiltonians have edges whose sums are</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o2</span> <span class="op">&lt;-</span> <span class="va">o</span><span class="op">[</span><span class="fl">8</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/pathweights.html">path_weights</a></span><span class="op">(</span><span class="va">d7e</span>, <span class="va">o2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 84</span></span>
<span><span class="va">o3</span> <span class="op">&lt;-</span> <span class="va">o</span><span class="op">[</span><span class="fl">15</span><span class="op">:</span><span class="fl">22</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/pathweights.html">path_weights</a></span><span class="op">(</span><span class="va">d7e</span>, <span class="va">o3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 111</span></span></code></pre></div>
<p>The <code><a href="../reference/whpaths.html">weighted_hpaths()</a></code> function uses <code><a href="../reference/order_tsp.html">order_tsp()</a></code>, a TSP solver (by default nearest insertion) to come up with the first Hamiltonian. This algorithm uses heuristics, and may not find the overall winner. As the graph has just 7 nodes, it is possible to use brute force evaluation to find the shortest hamiltonian tour.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/order_best.html">order_best</a></span><span class="op">(</span><span class="va">d7</span>,cycle<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4 5 1 7 3 2 6</span></span>
<span><span class="fu"><a href="../reference/order_tsp.html">order_tsp</a></span><span class="op">(</span><span class="va">d7</span>,cycle<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4 5 7 1 6 2 3</span></span></code></pre></div>
<p>In this example, we can confirm that <code>order_tsp</code> finds the shortest Hamiltonian tour. As <code>order_best</code> is computationally highly demanding, if you try it for graphs with more that <code>maxexact</code> (defaults to 9) nodes, only a sample of permutations is evaluated.</p>
</div>
<div class="section level2">
<h2 id="comparisions-of-edge-traversals-on-an-unweighted-complete-graph">Comparisions of edge traversals on an unweighted complete graph<a class="anchor" aria-label="anchor" href="#comparisions-of-edge-traversals-on-an-unweighted-complete-graph"></a>
</h2>
<p>Consider the graph <code>k7</code>. At his stage, we have four algorithms for forming Eulerians which do not use weights. These are</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eseq.html">eseq</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">e2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eseq.html">eseqa</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">e3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eulerian.html">eulerian</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span> <span class="co"># same path as eulerian(k7, weighted=FALSE)</span></span>
<span><span class="va">h1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hpaths.html">hpaths</a></span><span class="op">(</span><span class="fl">7</span>, matrix<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="PairVizIntroduction_files/figure-html/unnamed-chunk-27-1.png" width="672"></p>
<p>The plot of <code>eseq(7)</code> is coloured to show its recursive construction. <code>eseq(3)</code> is in tan, the additional edges added for <code>eseq(5)</code> are in blue, while those for <code>eseq(7)</code> are in pink.</p>
<p>The plot of <code>eseqa(7)</code> shows its construction; edges are a distance 1 (in tan), 2 (in blue) and 3 (in pink) apart repeatedly, considering the last node 7 and the first to be a distance 1 apart.</p>
<p>In <code>eulerian(7)</code>, edges connecting to node 1 are in tan, edges from nodes 2 and 3 are in blue excepting those connecting node 1, while remaining edges involving nodes 4,5, 6 and 7 only are in pink. This display illustrates that the eulerian algorithm always moves to the lowest available node.</p>
<p>In the plot of <code>hpaths(7)</code> the three concatenated hamiltonians are coloured blue, pink and tan.</p>
<p>From these displays, if you want an eulerian visiting the low numbered nodes first, use <code><a href="../reference/eseq.html">eseq()</a></code> or <code><a href="../reference/eulerian.html">eulerian()</a></code>. If you want an Eulerian where visits to a node are spread out, pick <code><a href="../reference/eseq.html">eseqa()</a></code> or <code><a href="../reference/hpaths.html">hpaths()</a></code>. And of course, if the Hamiltonian property is important, then <code><a href="../reference/hpaths.html">hpaths()</a></code> is the best choice.</p>
</div>
<div class="section level2">
<h2 id="comparisions-of-edge-traversals-on-an-weighted-complete-graph">Comparisions of edge traversals on an weighted complete graph<a class="anchor" aria-label="anchor" href="#comparisions-of-edge-traversals-on-an-weighted-complete-graph"></a>
</h2>
<p>We have two different Eulerians for an edge-weighted <code>k7</code>. These are</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eulerian.html">eulerian</a></span><span class="op">(</span><span class="va">d7</span><span class="op">)</span> <span class="co"># same path as eulerian(k7)</span></span>
<span><span class="va">h2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/whpaths.html">weighted_hpaths</a></span><span class="op">(</span><span class="va">d7</span>, matrix<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>which are plotted below. The colouring scheme used here is the same as that for the plots of <code>eulerian(7)</code> and <code>hpaths(7)</code>.</p>
<p><img src="PairVizIntroduction_files/figure-html/unnamed-chunk-29-1.png" width="672"></p>
<p>Recall that the goal of our traversals of edge-weights graphs was to visit low-weight edges early in the path. To check this, we can find the edges weights for the paths using</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d7e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pathweights.html">dist2edge</a></span><span class="op">(</span><span class="va">d7</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/pathweights.html">path_weights</a></span><span class="op">(</span><span class="va">d7e</span>, <span class="va">e4</span><span class="op">)</span> <span class="co"># the edge weights for e4</span></span>
<span><span class="co">#&gt;  [1]  1  3  2  7  5  4 10 14  9  6 11 12 16  8 13 17 18 19 15 21 20</span></span>
<span><span class="fu"><a href="../reference/pathweights.html">path_weights</a></span><span class="op">(</span><span class="va">d7e</span>, <span class="va">h2</span><span class="op">)</span> <span class="co"># the edge weights for h2</span></span>
<span><span class="co">#&gt;  [1]  1  7  2 10  4  6  9 14  3  5 21  8 18 12 11 15 19 13 17 16 20</span></span></code></pre></div>
<p>Plotting these, we see that the edge weights for both <code>e4</code> and <code>h2</code> increase as the index increases. The path based on Hamiltonians is less successful at ordering the edge weights as it must visit a sequence of Hamiltonians. The edge weights for the first Hamiltonian are in blue, for the second in magenta and the third in tan.</p>
<p><img src="PairVizIntroduction_files/figure-html/unnamed-chunk-31-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>C.B. Hurley and R.W. Oldford, Pairwise display of high dimensional information via Eulerian tours and Hamiltonian decompositions. Journal of Computational and Graphical Statistics. 19(10), pp. 861–886, 2010.</p>
<p>C.B. Hurley and R.W. Oldford, Eulerian tour algorithms for data visualization and the PairViz package. Computational Statistics, 26(4), pp 613–633, 2011.</p>
<!-- You can enable figure captions by `fig_caption: yes` in YAML: -->
<!--     output: -->
<!--       rmarkdown::html_vignette: -->
<!--         fig_caption: yes -->
<!-- Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**. -->
<!-- ## More Examples -->
<!-- You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`. -->
<!-- ```{r, echo=FALSE, results='asis'} -->
<!-- knitr::kable(head(mtcars, 10)) -->
<!-- ``` -->
<!-- Also a quote using `>`: -->
<!-- > "He who gives up [code] safety for [code] speed deserves neither." -->
<!-- ([via](https://twitter.com/hadleywickham/status/504368538874703872)) -->
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Catherine Hurley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
